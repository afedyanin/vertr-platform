@page "/instruments"
@using Vertr.Platform.Host.Components.Common

<h3>Instruments</h3>

<FluentPaginator State="@pagination" SummaryTemplate="@template" />

<FluentDataGrid TGridItem=Person
    OnRowClick="HandleRowClick"
    OnRowFocus="HandleRowFocus"
    OnCellClick="HandleCellClick"
    OnCellFocus="HandleCellFocus"
    Items="@people"
    Pagination="@pagination"
    RowSize="@DataGridRowSize.Medium">
    <PropertyColumn Property="@(p => p.PersonId)" Sortable="true" />
    <PropertyColumn Property="@(p => p.Name)" Sortable="true" />
    <PropertyColumn Property="@(p => p.BirthDate)" Format="yyyy-MM-dd" Sortable="true" />
    <TemplateColumn Title="Bonus">
        <FluentButton Appearance="Appearance.Accent" @onclick="@(() => Bonus(context))">Regular</FluentButton>
        <FluentButton Appearance="Appearance.Accent" @onclick="@(() => DoubleBonus(context))">Double</FluentButton>
    </TemplateColumn>
</FluentDataGrid>

<FluentPaginator State="@pagination" />

<p><strong>@message</strong></p>

@code {
    string message = string.Empty;

    PaginationState pagination = new PaginationState() { ItemsPerPage = 2 };

    record Person(int PersonId, string Name, DateOnly BirthDate);

    IQueryable<Person> people = new[]
    {
        new Person(10895, "Jean Martin", new DateOnly(1985, 3, 16)),
        new Person(10944, "Ant√≥nio Langa", new DateOnly(1991, 12, 1)),
        new Person(11203, "Julie Smith", new DateOnly(1958, 10, 10)),
        new Person(11205, "Nur Sari", new DateOnly(1922, 4, 27)),
        new Person(11898, "Jose Hernandez", new DateOnly(2011, 5, 3)),
        new Person(12130, "Kenji Sato", new DateOnly(2004, 1, 9)),
    }.AsQueryable();

    private RenderFragment template = @<span />;

    void Bonus(Person p) => message = $"You want to give {p.Name} a regular bonus";

    void DoubleBonus(Person p) => message = $"You want to give {p.Name} a double bonus";

    private void HandleRowClick(FluentDataGridRow<Person> row)
    {
        DemoLogger.WriteLine($"Row clicked: {row.RowIndex}");
    }

    private void HandleRowFocus(FluentDataGridRow<Person> row)
    {
        DemoLogger.WriteLine($"Row focused: {row.RowIndex}");
    }

    private void HandleCellClick(FluentDataGridCell<Person> cell)
    {
        DemoLogger.WriteLine($"Cell clicked: {cell.GridColumn}");
    }

    private void HandleCellFocus(FluentDataGridCell<Person> cell)
    {
        DemoLogger.WriteLine($"Cell focused : {cell.GridColumn}");
    }
}
