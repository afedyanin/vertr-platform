@page "/strategies/details/{StrategyId}"

@using Vertr.MarketData.Contracts
@using Vertr.Platform.BlazorUI.Components.Models
@using Vertr.Strategies.Contracts
@using Vertr.PortfolioManager.Contracts;

@inject IDialogService DialogService
@inject NavigationManager Navigation

<h3>Strategy Details</h3>

@if (Content != null)
{
    <FluentButton IconEnd="@(new Icons.Regular.Size16.Delete())"
                  Appearance=Appearance.Lightweight
                  Title="Delete"
                  @onclick="@(async () => await HandleDeleteAction())" />

    <FluentTextField Value="@Content.Strategy.Id.ToString()" ReadOnly Appearance="FluentInputAppearance.Filled" style="width: 100%;">Id:</FluentTextField>
    <FluentTextField Value="@Content.Strategy.CreatedAt.ToString()" ReadOnly Appearance="FluentInputAppearance.Filled" style="width: 100%;">Created At:</FluentTextField>
    <FluentTextField @bind-Value="@Content.Strategy.Name" Appearance="FluentInputAppearance.Filled" style="width: 100%;">Name:</FluentTextField>

    <FluentSelect Items="@(Enum.GetValues<StrategyType>())"
        @bind-SelectedOption="@Content.Strategy.Type"
        Label="Type:"
        style="width: 100%;" />

    <FluentSelect TOption="Instrument"
        Label="Instrument"
        Items="@AllInstruments"
        OptionValue="@(p => p.Id.ToString())"
        OptionText="@(p => p.GetFullName())"
        @bind-SelectedOption="@Content.Instrument" />

    <FluentNumberField @bind-Value="@Content.Strategy.QtyLots" Appearance="FluentInputAppearance.Filled" style="width: 100%;">Qty lots:</FluentNumberField>
    <FluentCheckbox @bind-Value="@Content.Strategy.IsActive" Appearance="FluentInputAppearance.Filled" style="width: 100%;" Label="Is Active"></FluentCheckbox>
    <br />
    <br />

    @if (Content.Strategy.PortfolioId != Guid.Empty)
    {
        <FluentTextField Value="@Content.Strategy.PortfolioId.ToString()" ReadOnly Appearance="FluentInputAppearance.Filled" style="width: 100%;">Portfolio Id:</FluentTextField>
        <FluentAnchor Href=@_portfolioDetailsLink>Go to portfolio</FluentAnchor>
    }
}
else
{
    <h4>Strategy is not found</h4>
}
